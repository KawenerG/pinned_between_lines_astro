---
import { getCollection, getEntry } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { base } from "../../utils/env";
const { slug } = Astro.params as { slug: string };
const review = await getEntry("reviews", slug);
if (!review) throw new Error("Not found");

export async function getStaticPaths() {
  const entries = await getCollection("reviews");
  return entries.map((entry) => ({
    params: { slug: entry.slug }, //string
  }));
}
---
<BaseLayout title={review.data.title}>
  <section class="review-content">
<article>
  <h1 style="font-size: 1.8rem; font-weight: bold;">
  {review.data.title}
  <span style="font-size: 1rem; font-weight: normal; color: #666; margin-left: 0.5em;">
    by {review.data.author}
  </span>
</h1>
  <p><em>{review.data.reviewDate.replace(/-/g, ".")}</em></p>
  {review.data.showAmazonCover && review.data.cover && (
    <div style="display: flex; align-items: center; gap: 50px; margin-left: 12px;">
      <div style="flex: 0 0 auto;">
        <a href={review.data.buyLink} target="_blank">
          <img
            src={`${base}/assets/covers/${review.data.cover}`}
            alt={`${review.data.title} å°é¢`}
            width="160"
          />
        </a>
      </div>
      <div style="font-size: 0.85em; color: #555;">
        <strong>{review.data.title}</strong><br />
        <em>{review.data.authorDate.replace(/-/g, ".")}</em><br />
        å°é¢æ¥æºï¼šAmazon<br />
        <a href={review.data.buyLink} target="_blank">ç‚¹å‡»è´­ä¹°</a>
      </div>
    </div>
  )}
  {review.data.series && <p>ğŸ“‚ ç³»åˆ—ï¼š{review.data.series}</p>}
  {review.data.tags && (
    <p>
      ğŸ·ï¸ æ ‡ç­¾ï¼š
      {review.data.tags.map((tag) => (
        <span style="display: inline-block; margin-right: 8px; padding: 2px 6px; background: #eee; border-radius: 6px; font-size: 0.85em;">
          {tag}
        </span>
      ))}
    </p>
  )}
  <p style="margin-top: 0; font-size: 0.95rem; color: #888;">
  è¯„åˆ†ï¼š{review.data.rating} / 10
  </p>
   <div class="prose prose-zinc mt-6">
  {(await review.render()).Content({}, {}, {})}
  </div>
</article>
</section>
</BaseLayout>